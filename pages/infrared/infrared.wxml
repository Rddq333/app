<cu-custom bgColor="bg-white" isBack="{{true}}">
    <view slot="content">红外理疗</view>
</cu-custom>

<view class="status-card">
  <view class="status-header">
    <van-icon name="fire" size="40px" color="#f59e42" />
    <view class="status-info">
      <view class="status-title">红外理疗系统</view>
      <view class="status-desc">智能照射，深层理疗</view>
    </view>
    <van-tag type="{{status === 'running' ? 'success' : 'default'}}" size="large">
      {{status === 'running' ? '运行中' : '已停止'}}
    </van-tag>
  </view>
</view>
<!-- 设备状态提示 -->
<view class="device-status" wx:if="{{!isRunning}}">
  <van-cell-group>
    <van-cell title="设备状态" value="{{deviceStatus}}" />
    <van-cell title="连接状态" value="{{deviceConnected ? '已连接' : '未连接'}}" />
  </van-cell-group>
</view>
<view class="infrared-container">
  <view class="section-title">基础治疗参数</view>
  <!-- 温度 -->
  <view class="param-row">
    <text class="param-label">温度</text>
    <slider min="40" max="60" step="1" value="{{params.temp}}" bindchange="onTempChange" show-value />
    <view class="quick-btns">
      <button wx:for="{{params.tempQuick}}" wx:key="item" size="mini" class="quick-btn" data-value="{{item}}" bindtap="onQuickTemp">{{item}}℃</button>
    </view>
    <text class="param-value">{{params.temp}}℃</text>
  </view>
  <!-- 波长 -->
  <view class="param-row">
    <text class="param-label">波长</text>
    <radio-group bindchange="onWavelengthChange">
      <label wx:for="{{params.wavelengthOptions}}" wx:key="item">
        <radio value="{{item}}" checked="{{params.wavelength === item}}" />{{item}}
      </label>
    </radio-group>
  </view>
  <!-- 治疗时间 -->
  <view class="param-row">
    <text class="param-label">治疗时间</text>
    <picker mode="selector" range="{{params.timeOptions}}" value="{{timeIndex}}" bindchange="onTimeChange">
      <view class="picker-value">{{params.time}}分钟</view>
    </picker>
  </view>
  <!-- 照射距离 -->
  <view class="param-row">
    <text class="param-label">照射距离</text>
    <slider min="20" max="50" step="1" value="{{params.distance}}" bindchange="onDistanceChange" show-value />
    <text class="param-value">{{params.distance}}cm</text>
  </view>

  <view class="section-title">照射区域</view>
  <view class="param-row">
    <text class="param-label">照射模式</text>
    <picker mode="selector" range="{{params.areaModeOptions}}" value="{{areaModeIndex}}" bindchange="onAreaModeChange">
      <view class="picker-value">{{params.areaMode}}</view>
    </picker>
  </view>
 

  <view class="section-title">智能安全参数</view>
  <!-- 皮肤温度监测 -->
  <view class="param-row">
    <text class="param-label">皮肤温度监测</text>
    <switch checked="{{params.skinTempMonitor}}" bindchange="onSkinTempMonitorChange" />
  </view>
  <!-- 自动断电保护 -->
  <view class="param-row">
    <text class="param-label">自动断电保护</text>
    <switch checked="{{params.autoPowerOff}}" bindchange="onAutoPowerOffChange" />
  </view>
  <!-- 使用间隔提醒 -->
  <view class="param-row">
    <text class="param-label">使用间隔提醒</text>
    <switch checked="{{params.intervalRemind}}" bindchange="onIntervalRemindChange" />
  </view>

  <view class="config-card" wx:if="{{isRunning}}">
    <view class="section-title">运行信息</view>
    <van-cell-group>
      <van-cell title="运行时间" value="{{runningTime}}" />
      <van-cell title="剩余时间" value="{{remainingTime}}" />
      <van-cell title="当前温度" value="{{params.temp}}℃" />
      <van-cell title="当前波长" value="{{params.wavelength}}" />
      <van-cell title="当前状态" value="{{isRunning ? '运行中' : (status === 'paused' ? '已暂停' : '已停止')}}" />
    </van-cell-group>
  </view>

  <view class="control-buttons">
    <van-button 
      type="{{isRunning ? (status === 'paused' ? 'primary' : 'warning') : 'primary'}}" 
      size="large" 
      block 
      custom-class="round-btn"
      bind:tap="onToggle"
      loading="{{loading}}"
    >
      {{isRunning ? (status === 'paused' ? '继续' : '暂停') : '启动'}}
    </van-button>
    <van-button 
      wx:if="{{isRunning}}" 
      type="danger" 
      size="large" 
      block 
      custom-class="round-btn"
      bind:tap="stopInfrared"
      style="margin-top: 10px;"
    >
      结束
    </van-button>
  </view>
</view> 